---
import { getCollection, type CollectionEntry } from "astro:content";
import ContentLayout from "../../layouts/ContentLayout.astro";

const { slug } = Astro.params;
const entries: CollectionEntry<"casos">[] = await getCollection(
  "casos",
  ({ data }) => !data.draft
);
const entry = entries.find((p) => p.slug === slug);

if (!entry) {
  throw new Error(`Caso no encontrado: ${slug}`);
}

const { Content } = await entry.render();
export async function getStaticPaths() {
  const all = await getCollection("casos");
  return all.map((p) => ({ params: { slug: p.slug } }));
}
---

<ContentLayout
  title={entry.data.title}
  slug={entry.slug}
  description={entry.data.description}
  cover={entry.data.cover}
>
  <article class="mx-auto max-w-3xl px-4 py-10 flex flex-col gap-6">
    <div class="prose prose-neutral !max-w-none">
      <Content />
    </div>
  </article>
</ContentLayout>
